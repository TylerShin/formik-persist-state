(function(u,s){typeof exports=="object"&&typeof module!="undefined"?s(exports,require("formik"),require("react")):typeof define=="function"&&define.amd?define(["exports","formik","react"],s):(u=typeof globalThis!="undefined"?globalThis:u||self,s(u.FormikPersistState={},u.Formik,u.React))})(this,function(u,s,l){"use strict";var d=typeof Element!="undefined",m=typeof Map=="function",v=typeof Set=="function",w=typeof ArrayBuffer=="function"&&!!ArrayBuffer.isView;function i(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){if(e.constructor!==t.constructor)return!1;var n,r,f;if(Array.isArray(e)){if(n=e.length,n!=t.length)return!1;for(r=n;r--!==0;)if(!i(e[r],t[r]))return!1;return!0}var o;if(m&&e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(o=e.entries();!(r=o.next()).done;)if(!t.has(r.value[0]))return!1;for(o=e.entries();!(r=o.next()).done;)if(!i(r.value[1],t.get(r.value[0])))return!1;return!0}if(v&&e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(o=e.entries();!(r=o.next()).done;)if(!t.has(r.value[0]))return!1;return!0}if(w&&ArrayBuffer.isView(e)&&ArrayBuffer.isView(t)){if(n=e.length,n!=t.length)return!1;for(r=n;r--!==0;)if(e[r]!==t[r])return!1;return!0}if(e.constructor===RegExp)return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===t.toString();if(f=Object.keys(e),n=f.length,n!==Object.keys(t).length)return!1;for(r=n;r--!==0;)if(!Object.prototype.hasOwnProperty.call(t,f[r]))return!1;if(d&&e instanceof Element)return!1;for(r=n;r--!==0;)if(!((f[r]==="_owner"||f[r]==="__v"||f[r]==="__o")&&e.$$typeof)&&!i(e[f[r]],t[f[r]]))return!1;return!0}return e!==e&&t!==t}var S=function(t,n){try{return i(t,n)}catch(r){if((r.message||"").match(/stack|recursion/i))return console.warn("react-fast-compare cannot handle circular refs"),!1;throw r}};function y(e,t){return t?window.sessionStorage.getItem(e):window.localStorage.getItem(e)}const O=({cacheKey:e,sessionStorage:t,confirmMessage:n,debounceTiming:r=300})=>{const f=s.useFormikContext(),o=f.setFormikState,p=l.useRef();return l.useEffect(()=>{const a=y(e,t);if(!a)return;const c=JSON.parse(a);if(!!c.dirty){if(!n){o(c);return}window.confirm(n)?o(c):window.localStorage.removeItem(e)}},[e,t,n,o]),l.useEffect(()=>{const a=setTimeout(()=>{S(f,p.current)||(t?window.sessionStorage.setItem(e,JSON.stringify(f)):window.localStorage.setItem(e,JSON.stringify(f)),p.current=f)},r);return()=>{clearTimeout(a)}},[e,f,r,t]),null};u.Persist=O,Object.defineProperties(u,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
