"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});var c=require("formik"),a=require("react"),p=typeof Element!="undefined",v=typeof Map=="function",w=typeof Set=="function",m=typeof ArrayBuffer=="function"&&!!ArrayBuffer.isView;function s(e,r){if(e===r)return!0;if(e&&r&&typeof e=="object"&&typeof r=="object"){if(e.constructor!==r.constructor)return!1;var n,t,f;if(Array.isArray(e)){if(n=e.length,n!=r.length)return!1;for(t=n;t--!==0;)if(!s(e[t],r[t]))return!1;return!0}var o;if(v&&e instanceof Map&&r instanceof Map){if(e.size!==r.size)return!1;for(o=e.entries();!(t=o.next()).done;)if(!r.has(t.value[0]))return!1;for(o=e.entries();!(t=o.next()).done;)if(!s(t.value[1],r.get(t.value[0])))return!1;return!0}if(w&&e instanceof Set&&r instanceof Set){if(e.size!==r.size)return!1;for(o=e.entries();!(t=o.next()).done;)if(!r.has(t.value[0]))return!1;return!0}if(m&&ArrayBuffer.isView(e)&&ArrayBuffer.isView(r)){if(n=e.length,n!=r.length)return!1;for(t=n;t--!==0;)if(e[t]!==r[t])return!1;return!0}if(e.constructor===RegExp)return e.source===r.source&&e.flags===r.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===r.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===r.toString();if(f=Object.keys(e),n=f.length,n!==Object.keys(r).length)return!1;for(t=n;t--!==0;)if(!Object.prototype.hasOwnProperty.call(r,f[t]))return!1;if(p&&e instanceof Element)return!1;for(t=n;t--!==0;)if(!((f[t]==="_owner"||f[t]==="__v"||f[t]==="__o")&&e.$$typeof)&&!s(e[f[t]],r[f[t]]))return!1;return!0}return e!==e&&r!==r}var d=function(r,n){try{return s(r,n)}catch(t){if((t.message||"").match(/stack|recursion/i))return console.warn("react-fast-compare cannot handle circular refs"),!1;throw t}};function S(e,r){return r?window.sessionStorage.getItem(e):window.localStorage.getItem(e)}const O=({cacheKey:e,sessionStorage:r,confirmMessage:n,debounceTiming:t=300})=>{const f=c.useFormikContext(),o=f.setFormikState,l=a.useRef();return a.useEffect(()=>{const u=S(e,r);if(!u)return;const i=JSON.parse(u);if(!!i.dirty){if(!n){o(i);return}window.confirm(n)?o(i):window.localStorage.removeItem(e)}},[e,r,n,o]),a.useEffect(()=>{const u=setTimeout(()=>{d(f,l.current)||(r?window.sessionStorage.setItem(e,JSON.stringify(f)):window.localStorage.setItem(e,JSON.stringify(f)),l.current=f)},t);return()=>{clearTimeout(u)}},[e,f,t,r]),null};exports.Persist=O;
